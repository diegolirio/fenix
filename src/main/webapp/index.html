<!DOCTYPE html>
<html ng-app="fenix">
<head>
	<meta charset="ISO-8859-1">
	<title>Fenix</title>
    <link rel="stylesheet" href="./node_modules/materialize-css/dist/css/materialize.min.css">
</head>
<body>
  
  <div ng-include="'./menu.html'"></div>
  <div ng-view></div>  
	
  <script type="text/javascript" src="./node_modules/angular/angular.min.js"></script>
  <script type="text/javascript" src="./node_modules/angular-route/angular-route.min.js"></script>
  <script type="text/javascript">
  		var fenix = angular.module('fenix', ['ngRoute']);  
  		  
  		fenix.config(['$locationProvider', '$routeProvider', function($locationProvider, $routeProvider) {
  		  	  $locationProvider.hashPrefix('');
	  		  $routeProvider 
				.when('/', { templateUrl:'./home.html'})     
	  			.when('/oficina/cadastro', { templateUrl: 'oficina-cadastro.html' });  		  	
  		}]);
  		  		  
  		
  		fenix.controller('OficinaController', ['$http', function($http) {
  		
  			var self = this;
  			
  			self.init = function() {
  				self.findAll();
  			}
  			
  			self.findAll = function() {
	  			$http.get('/oficina/findall').then(function(resp) {
	  				self.oficinas = resp.data;
	  			}, function(error) {
	  				alert(error.data);
	  			});
  			}
  			
  			self.save = function(oficina) {
  				$http.post('/oficina/save', oficina).then(function(resp) {
  					self.oficina = {};
  					self.findAll();
  				}, function(error) {
  					alert(error.data);
  				});
  			}
  			
  			self.edit = function(oficina) {
  				self.oficina = oficina;
  			}
  			
  			self.del = function(oficina) {
  				$http.post('/oficina/delete/'+oficina.id).then(function(resp) {
  					self.findAll();
  				}, function(error) {
  					alert(error.data);
  				});  				
  			} 
  			
  			self.editEndereco = function() {
  				alert('Em desenv');
  			}
  			
  			self.init(); 
  			
  		}]);
  		
  </script>      
        
</body>
</html>